# Сервис уведомлений

### Тестовое задание компании Фабрика решений
[Ссылка на задание](https://www.craft.do/s/n6OVYFVUpq0o6L)

## Описание

### Основное задание выполнено полностью

1. Решение построено на Django (DRF) + PostgreSQL + Celery + RabbitMQ + DJoser
2. Описание ручек в Swagger по адресу '/docs'. Также работает нативный интерфейс DRF по адресу '/'
3. По умолчанию проект запускается на 8000 порту
4. Все секреты хранятся в .env файле (см. пример этого файла .env.example). 
5. Запустить приложение можно двумя способами:
   - Запустить в контейнере с помощью docker-compose командой docker-compose up -d из корня проекта
   - Запуск в интерпретаторе питона:
     - Установить все зависимости (см. соответствующий блок)
     - Запустить PostgreSQL (например, через docker-compose из папки postgres-data)
     - Запустить RabbitMQ
     - Запустить celery: celery -A messenger worker -l info
     - Запустить проект в интерпретаторе питона: python manage.py runserver
6. Чтобы создать суперпользователя, воспользуйтесь командой python manage.py createsuperuser (при запуске через docker-compose нужно сначала войти в контейнер с помощью команды docker exec -it имя_контейнера sh, затем набрать python manage.py createsuperuser). Под этим пользователем можно зайти в админку Django.
7. Статистику по рассылкам можно получить, запросив список рассылок GET /mailings
8. Список всех сообщений конкретной рассылки по адресу GET /mailings/{ID рассылки}/messages
9. Фильтр для выбора клиентов для рассылки: **"код оператора 1","код оператора 2"|"тэг1,тэг2"**. То есть, можно указывать несколько операторов и несколько тэгов. Если нужно взять всех операторов и все тэги, достаточно в качестве фильтра задать '|'.
10. Реализована постановка всех активных рассылок в расписание при перезапуске приложения
11. Распределение доступа:
    - неавторизованный пользователь может только создать пользователя
    - пользователь user может просматривать и создавать (в демонстрационных целях этого тестового задания) клиентов, рассылки, сообщения.
    - пользователь admin имеет полные права, в том числе на изменение и удаление клиентов, рассылок, сообщений 

### Дополнительно реализовано
1. Запуск приложения в контейнере через docker-compose
2. Запуск Swagger UI по адресу /docs
3. Список всех сообщений конкретной рассылки по адресу GET /mailings/{ID рассылки}/messages
4. Организован доступ к API через JWT
5. Реализован административный Web UI (в том числе, управление пользователями сервиса + разграничение прав доступа). В целях безопасности при создании пользователя нельзя задать ему роль admin. Это можно сделать в админке Django от лица другого администратора. Создать пользователя-администратора можно через команду python3 createsuperuser.

## Зависимости
1. Django==4.0.4
2. PostgreSQL
3. celery==5.2.6
4. RabbitMQ
5. django-environ==0.8.1
6. djangorestframework==3.13.1
7. djangorestframework-simplejwt==5.1.0
8. drf-spectacular==0.22.0
9. psycopg2==2.9.3
10. requests==2.27.1
11. djoser==2.1.0
12. django-phonenumbers==1.0.1

См. полный список зависимостей в requirements.txt